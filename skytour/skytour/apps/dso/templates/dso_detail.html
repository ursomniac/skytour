{% extends "base.html" %}
{% load skytour_filters %}
{% block title %}{{ object.shown_name}}: Skytour{% endblock title %}
{% block styles %}
<style>
	table.lite { border-style: none; }
	table.lite td { border-style: none;}
	h1 { font-weight: bold; font-size: 250%; color: #fff; }
	td { vertical-align: top;}
	td.object_name { vertical-align: middle; padding-left: 20px; }
	td.description { vertical-align: middle!important; text-align: center; line-height: 1.75; color: #FFF;}
	td.description a { color: #ff0; }
	td.aliases { padding-left: 20px; padding-bottom: 20px; color: #ff0; }
	td.dso_image { padding: 0; }
	td.coordinates { font-size: 150%; padding-bottom: 10px; }
	table.info_box { border: 2px solid black }
	tr.bottom { height: 150px; }
</style>
{% endblock styles %}

{% block content %}
<br>
<table>
<!-- main -->
{# header section #}
<tr>
	<td colspan=2 class="lite">
		<a name="top"></a>
		<table width="100%" class="lite" bgcolor="{{ object.object_type.bgcolor}}" width=100%>
			<tr>
				<td width=60% class="object_name">
					<h1>
						{{ object.shown_name }}
						{% if object.nickname %}
						&nbsp;&mdash;&nbsp;
						{{ object.nickname }}
						{% endif %}
					</h1>
				</td>
				<td width=20% class="description" rowspan=2>
					<a href="{% url 'object-type-detail' object.object_type.slug %}">{{ object.object_type }}</a>
					<br>in<br>
					<b>
						<a href="{% url 'constellation-detail' object.constellation.abbreviation %}">
							{{ object.constellation.abbreviation }}
						</a>
					</b>
				</td>
				<td width=20% class="description" rowspan=2>
					<b>Priority:&nbsp;
						<a href="{% url 'priority-detail' object.priority %}">{{ object.priority }}</a>
					<br>
					<b>On Skymap:&nbsp;</b>{{ object.get_show_on_skymap_display }}
					<br>
					<a href="/admin/dso/dso/{{ object.pk }}"><button>Admin</button></a>
					<a href="/media/{{ object.pdf_page }}" target="_new"><button>PDF</button>
				</td>
			</tr>
			{% if object.alias_list %}
			<tr><td class="aliases">{{ object.alias_list }}</td></tr>
			{% endif %}
		</table>
	</td>
</tr>

<tr>
	<td id="metadata" colspan=2>
		<h3>Information:</h3>
		<table width=100% class="lite">
			<tr>
				<td class="coordinates">&alpha; (2000): {{ object.ra_text }}</td>
				<td class="coordinates">&delta; (2000): {{ object.dec_text }}</td>
			</tr>
			<tr>
				<td>V: {{ object.magnitude }}</td>
				<td>Cul. Date: {{ object.opposition_date|date:"M d" }}</td>
			</tr>
			<tr>
				<td>Surf. Bri: {{ object.surface_brightness }}</td>
				<td>Ang. Size: {{ object.angular_size }}</td>
			<tr>
				<td>Contrast Index: {{ object.contrast_index }}</td>
				<td>Distance: {{ object.distance }} {{ object.distance_units }}</td>
			</tr>
			<tr>
				<td>On Atlas Plates: {# object.atlas_plate_list #}
					{% for plate in object.atlasplate_set.all %}
					<a href="{% url 'atlas-detail' plate.slug %}" target="_new">{{ plate.plate_id }}<a>
					{% if not forloop.last %}, {% endif %}
					{% endfor %}
				</td>
				<td>Morphological Type: {{ object.morphological_type }}</td>
			</tr>
		</table>
	</td>
</tr>

<tr>
	<td id="finder" width=50%>
		<a name="charts"></a>
		<h3>DSO Finder Chart:</h3>
	{% comment %}
		{% if object.dso_finder_chart %}
		<img src="{{ object.dso_finder_chart.url }}" width=100%>
		{% else %}
		<br>(No finder chart.)
		{% endif %}
	{% endcomment %}
		<img src="{{ live_finder_chart }}" width=100%>
	</td>
	<td id="close_up" width=50%>
		<h3>Close-Up Finder Chart:</h3>
		<img src="{{ close_up_finder }}" width=100%>
	</td>
</tr>
</table>
<table>
<tr>
	<td>
		<a name="nearby_dsos"></a>
		<h3>Nearby DSOs ({{ object.nearby_dsos|length }})</h2>
			<small>
			{% if object.nearby_dsos|length > 0 %}<table class="lite">{% endif %}
			{% for x in object.nearby_dsos %}
			{% if forloop.counter0|modulus:5 == 0 %}<tr>{% endif %}
				<td width="20%">
					<a href="{% url 'dso-detail' x.pk %}">{{ x.shown_name }}</a>
					({{ x.object_type}}, 
					<span style="color: {{ x.priority_color }}">{{ x.priority }}</span>){% if not forloop.last %}, {% endif %}
				</td>
			{% if forloop.counter0|modulus:5 == 4  or forloop.last %}</tr>{% endif %}
			{% empty %}
			None
			{% endfor %}
			{% if object.nearby_dsos|length > 0 %}</table>{% endif %}
		</small>
	</td>
</tr>
</table>
<table>
<tr class="bottom">
	<td id="object_notes" valign="top" width=50% rowspan=2>
		<a name="notes"></a>
		<h3>Notes</h3>
		{{ object.notes|linebreaks }}
	</td>
	<td>
		<h3>Observations: {{ object.number_of_observations }}</h3>
		{% if object.number_of_observations > 0 %}
		<ul>
		{% for obs in object.observations.all %}
		<li>{{ obs.ut_datetime|date:"Y-m-d H:i" }} UT</li>
		{% endfor %}
		</ul>
		{% endif %}
	</td>
</tr>
</table>
<table class="lite">
<tr>
	<td class="dso_image" colspan=3 style="width:50%;">
		{% if object.images.all.0 %}
		<img src="{{ object.images.all.0.image.url }}" width=100% style="display:block;">
		{% endif %}
	</td>
	<td id="field_view" colspan=3 style="width:50%;">
		<!--h3>Field View:</h3-->
		{% if object.field_view %}
		<img src="{{ object.field_view.url }}" width=100% style="display:block;">
		{% else %}
		<br>(No field view.)
		{% endif %}
	</td>
</tr>

{% if object.images.all.1 %}
<tr class="bottom">

	<td class="dso_image" colspan=2 style="width:33%;">
		{% if object.images.all.1 %}
		<img src="{{ object.images.all.1.image.url }}" width=100%>
		{% endif %}
	</td>
	<td class="dso_image" colspan=2 style="width:33%;">
		{% if object.images.all.2 %}
		<img src="{{ object.images.all.2.image.url }}" width=100%>
		{% endif %}
	</td>
	<td class="dso_image" colspan=2 style="width=33%;">
		{% if object.images.all.3 %}
		<img src="{{ object.images.all.3.image.url }}" width=100%>
		{% endif %}
	</td>
</tr>
{% endif %}
</table>

{% with instance=object admin_dir='dso/dso'%}
{% include 'includes/observation_section.html' %}
{% endwith %}

{% include 'includes/performance_time.html' %}
{% endblock content %}
